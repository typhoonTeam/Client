<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="../css/carrie_style.css">
    <script src="../node_modules/jquery/dist/jquery.js"></script>
    <script src="../node_modules/bootstrap/dist/js/bootstrap.js"></script>
    <script src="../js/util.js"></script>
    <script src="../js/cartService.js"></script>
    <style>
        body{
            background-color: #ff7d52;
        }
        .shopName{
            font-size: 20px;
            font-weight: 700;
        }
        .totalPrice{
            position: absolute;
            right: 25px;
            height: 25px;
            line-height: 5px;
        }
        .order{
            position: relative;
        }
        .tp{
            color: #404040;
            font-family: Arial,Verdana;
            font-weight: 700;
            margin-right: 5px;
            color: #f40;
            font-size: 15px;
        }
        .order{

        }
    </style>


</head>
<body>
<div class="carrie_body">

    <br>
    <div id="carrie_header">
        <ul class="nav nav-tabs nav-justified">
            <li><a href="##">主页</a></li>
            <li><a href="##">登录</a></li>
            <li><a href="##">购物车</a></li>
            <li class="active"><a href="##">订单</a></li>
            <li><a href="##">我的</a></li>
        </ul>
    </div>
    <br>
    <br>
    <!-- order order list -->
    <div class="orderList">
        <div class="order">
            <div class="shopName">店名：沙拉店</div>
            <div class="foods">
                <table class="table table-hover table-bordered orderTalbe" id="fishDish">
                    <tr>
                    </tr>
                </table>
            </div>
            <div class="totalPrice">
                <div class="tp" >
                	<h3 id="total"></h3>
                </div>

            </div>
        </div>

    </div>

    <!-- order order list -->

    <script>
        let userId=sessionStorage.getItem("user");
        let shopId = GetRequest().shop_id;
        function GetRequest() {
            var url = location.search; //获取url中"?"符后的字串
            var theRequest = new Object();
            if (url.indexOf("?") != -1) {
                var str = url.substr(1);
                strs = str.split("&");
                for (var i = 0; i < strs.length; i++) {
                    theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
                }
            }
            return theRequest;
        }
        window.onload=function () {
            if(!userId){
                window.location("http://localhost:8081/typhoon_consuemer/html/login.html");
                return;
            }
            function renderDetail(foods) {
                let total =  0 ;
                for(let i=0;i<foods.length;i++){
                    let foodTr = '<tr><td width="50">'+foods[i].foodName+'</td>';
                    let imgTr = ' <td width="80"><img src="'+foods[i].picture+'" alt="" width="100"></td>';
                    let priceTr = ' <td width="20">￥'+foods[i].price+'</td>';
                    let numTr = '<td width="20">'+foods[i].num+'</td></tr>';
                    $("#fishDish").append(foodTr+imgTr+priceTr+numTr);
                    total += Number.parseInt(foods[i].price*foods[i].num);
                }
                
                document.getElementById("total").textContent= '总价 : ￥'+total;
               
            }
            function getData(userId,shopId){
                console.log(userId+shopId);
                let foods=$1.queryUserCart(userId,shopId);

                renderDetail(foods);
            }
            getData(userId,shopId);

        }
    </script>

</div>
</body>
</html>